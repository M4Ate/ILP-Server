package com.ilp.server.solver;

import org.json.JSONObject;
import org.junit.jupiter.api.Test;

import java.io.File;

import static org.junit.jupiter.api.Assertions.*;

@SuppressWarnings("NewClassNamingConvention")
class Solver_GLPKTest {

    @org.junit.jupiter.api.Test
    void solve() {
        Solver_GLPK solver = new Solver_GLPK();
        JSONObject input = new JSONObject("{\"variables\":[\"x_v0_c0\",\"x_v0_c1\",\"x_v0_c2\",\"x_v0_c3\",\"x_v0_c4\",\"x_v1_c0\",\"x_v1_c1\",\"x_v1_c2\",\"x_v1_c3\",\"x_v1_c4\",\"x_v2_c0\",\"x_v2_c1\",\"x_v2_c2\",\"x_v2_c3\",\"x_v2_c4\",\"x_v3_c0\",\"x_v3_c1\",\"x_v3_c2\",\"x_v3_c3\",\"x_v3_c4\",\"x_v4_c0\",\"x_v4_c1\",\"x_v4_c2\",\"x_v4_c3\",\"x_v4_c4\",\"y_e0_c0\",\"y_e0_c1\",\"y_e0_c2\",\"y_e0_c3\",\"y_e0_c4\",\"y_e1_c0\",\"y_e1_c1\",\"y_e1_c2\",\"y_e1_c3\",\"y_e1_c4\",\"y_e2_c0\",\"y_e2_c1\",\"y_e2_c2\",\"y_e2_c3\",\"y_e2_c4\",\"y_e3_c0\",\"y_e3_c1\",\"y_e3_c2\",\"y_e3_c3\",\"y_e3_c4\",\"y_e4_c0\",\"y_e4_c1\",\"y_e4_c2\",\"y_e4_c3\",\"y_e4_c4\",\"y_e5_c0\",\"y_e5_c1\",\"y_e5_c2\",\"y_e5_c3\",\"y_e5_c4\",\"y_e6_c0\",\"y_e6_c1\",\"y_e6_c2\",\"y_e6_c3\",\"y_e6_c4\",\"z_c0\",\"z_c1\",\"z_c2\",\"z_c3\",\"z_c4\"],\"constraints\":[\"x_v0_c0 + x_v0_c1 + x_v0_c2 + x_v0_c3 + x_v0_c4 = 1\",\"x_v1_c0 + x_v1_c1 + x_v1_c2 + x_v1_c3 + x_v1_c4 = 1\",\"x_v2_c0 + x_v2_c1 + x_v2_c2 + x_v2_c3 + x_v2_c4 = 1\",\"x_v3_c0 + x_v3_c1 + x_v3_c2 + x_v3_c3 + x_v3_c4 = 1\",\"x_v4_c0 + x_v4_c1 + x_v4_c2 + x_v4_c3 + x_v4_c4 = 1\",\"y_e0_c0 + y_e0_c1 + y_e0_c2 + y_e0_c3 + y_e0_c4 = 1\",\"y_e1_c0 + y_e1_c1 + y_e1_c2 + y_e1_c3 + y_e1_c4 = 1\",\"y_e2_c0 + y_e2_c1 + y_e2_c2 + y_e2_c3 + y_e2_c4 = 1\",\"y_e3_c0 + y_e3_c1 + y_e3_c2 + y_e3_c3 + y_e3_c4 = 1\",\"y_e4_c0 + y_e4_c1 + y_e4_c2 + y_e4_c3 + y_e4_c4 = 1\",\"y_e5_c0 + y_e5_c1 + y_e5_c2 + y_e5_c3 + y_e5_c4 = 1\",\"y_e6_c0 + y_e6_c1 + y_e6_c2 + y_e6_c3 + y_e6_c4 = 1\",\"x_v1_c0 + x_v3_c0 <= 1\",\"x_v1_c1 + x_v3_c1 <= 1\",\"x_v1_c2 + x_v3_c2 <= 1\",\"x_v1_c3 + x_v3_c3 <= 1\",\"x_v1_c4 + x_v3_c4 <= 1\",\"x_v0_c0 + x_v2_c0 <= 1\",\"x_v0_c1 + x_v2_c1 <= 1\",\"x_v0_c2 + x_v2_c2 <= 1\",\"x_v0_c3 + x_v2_c3 <= 1\",\"x_v0_c4 + x_v2_c4 <= 1\",\"x_v4_c0 + x_v0_c0 <= 1\",\"x_v4_c1 + x_v0_c1 <= 1\",\"x_v4_c2 + x_v0_c2 <= 1\",\"x_v4_c3 + x_v0_c3 <= 1\",\"x_v4_c4 + x_v0_c4 <= 1\",\"x_v3_c0 + x_v4_c0 <= 1\",\"x_v3_c1 + x_v4_c1 <= 1\",\"x_v3_c2 + x_v4_c2 <= 1\",\"x_v3_c3 + x_v4_c3 <= 1\",\"x_v3_c4 + x_v4_c4 <= 1\",\"x_v2_c0 + x_v3_c0 <= 1\",\"x_v2_c1 + x_v3_c1 <= 1\",\"x_v2_c2 + x_v3_c2 <= 1\",\"x_v2_c3 + x_v3_c3 <= 1\",\"x_v2_c4 + x_v3_c4 <= 1\",\"x_v1_c0 + x_v2_c0 <= 1\",\"x_v1_c1 + x_v2_c1 <= 1\",\"x_v1_c2 + x_v2_c2 <= 1\",\"x_v1_c3 + x_v2_c3 <= 1\",\"x_v1_c4 + x_v2_c4 <= 1\",\"x_v0_c0 + x_v1_c0 <= 1\",\"x_v0_c1 + x_v1_c1 <= 1\",\"x_v0_c2 + x_v1_c2 <= 1\",\"x_v0_c3 + x_v1_c3 <= 1\",\"x_v0_c4 + x_v1_c4 <= 1\",\"x_v0_c0 + y_e1_c0 + y_e2_c0 + y_e6_c0 <= 1\",\"x_v0_c1 + y_e1_c1 + y_e2_c1 + y_e6_c1 <= 1\",\"x_v0_c2 + y_e1_c2 + y_e2_c2 + y_e6_c2 <= 1\",\"x_v0_c3 + y_e1_c3 + y_e2_c3 + y_e6_c3 <= 1\",\"x_v0_c4 + y_e1_c4 + y_e2_c4 + y_e6_c4 <= 1\",\"x_v1_c0 + y_e0_c0 + y_e5_c0 + y_e6_c0 <= 1\",\"x_v1_c1 + y_e0_c1 + y_e5_c1 + y_e6_c1 <= 1\",\"x_v1_c2 + y_e0_c2 + y_e5_c2 + y_e6_c2 <= 1\",\"x_v1_c3 + y_e0_c3 + y_e5_c3 + y_e6_c3 <= 1\",\"x_v1_c4 + y_e0_c4 + y_e5_c4 + y_e6_c4 <= 1\",\"x_v2_c0 + y_e1_c0 + y_e4_c0 + y_e5_c0 <= 1\",\"x_v2_c1 + y_e1_c1 + y_e4_c1 + y_e5_c1 <= 1\",\"x_v2_c2 + y_e1_c2 + y_e4_c2 + y_e5_c2 <= 1\",\"x_v2_c3 + y_e1_c3 + y_e4_c3 + y_e5_c3 <= 1\",\"x_v2_c4 + y_e1_c4 + y_e4_c4 + y_e5_c4 <= 1\",\"x_v3_c0 + y_e0_c0 + y_e3_c0 + y_e4_c0 <= 1\",\"x_v3_c1 + y_e0_c1 + y_e3_c1 + y_e4_c1 <= 1\",\"x_v3_c2 + y_e0_c2 + y_e3_c2 + y_e4_c2 <= 1\",\"x_v3_c3 + y_e0_c3 + y_e3_c3 + y_e4_c3 <= 1\",\"x_v3_c4 + y_e0_c4 + y_e3_c4 + y_e4_c4 <= 1\",\"x_v4_c0 + y_e2_c0 + y_e3_c0 <= 1\",\"x_v4_c1 + y_e2_c1 + y_e3_c1 <= 1\",\"x_v4_c2 + y_e2_c2 + y_e3_c2 <= 1\",\"x_v4_c3 + y_e2_c3 + y_e3_c3 <= 1\",\"x_v4_c4 + y_e2_c4 + y_e3_c4 <= 1\",\"x_v0_c0 - z_c0 <= 0\",\"x_v0_c1 - z_c1 <= 0\",\"x_v0_c2 - z_c2 <= 0\",\"x_v0_c3 - z_c3 <= 0\",\"x_v0_c4 - z_c4 <= 0\",\"x_v1_c0 - z_c0 <= 0\",\"x_v1_c1 - z_c1 <= 0\",\"x_v1_c2 - z_c2 <= 0\",\"x_v1_c3 - z_c3 <= 0\",\"x_v1_c4 - z_c4 <= 0\",\"x_v2_c0 - z_c0 <= 0\",\"x_v2_c1 - z_c1 <= 0\",\"x_v2_c2 - z_c2 <= 0\",\"x_v2_c3 - z_c3 <= 0\",\"x_v2_c4 - z_c4 <= 0\",\"x_v3_c0 - z_c0 <= 0\",\"x_v3_c1 - z_c1 <= 0\",\"x_v3_c2 - z_c2 <= 0\",\"x_v3_c3 - z_c3 <= 0\",\"x_v3_c4 - z_c4 <= 0\",\"x_v4_c0 - z_c0 <= 0\",\"x_v4_c1 - z_c1 <= 0\",\"x_v4_c2 - z_c2 <= 0\",\"x_v4_c3 - z_c3 <= 0\",\"x_v4_c4 - z_c4 <= 0\",\"y_e0_c0 - z_c0 <= 0\",\"y_e0_c1 - z_c1 <= 0\",\"y_e0_c2 - z_c2 <= 0\",\"y_e0_c3 - z_c3 <= 0\",\"y_e0_c4 - z_c4 <= 0\",\"y_e1_c0 - z_c0 <= 0\",\"y_e1_c1 - z_c1 <= 0\",\"y_e1_c2 - z_c2 <= 0\",\"y_e1_c3 - z_c3 <= 0\",\"y_e1_c4 - z_c4 <= 0\",\"y_e2_c0 - z_c0 <= 0\",\"y_e2_c1 - z_c1 <= 0\",\"y_e2_c2 - z_c2 <= 0\",\"y_e2_c3 - z_c3 <= 0\",\"y_e2_c4 - z_c4 <= 0\",\"y_e3_c0 - z_c0 <= 0\",\"y_e3_c1 - z_c1 <= 0\",\"y_e3_c2 - z_c2 <= 0\",\"y_e3_c3 - z_c3 <= 0\",\"y_e3_c4 - z_c4 <= 0\",\"y_e4_c0 - z_c0 <= 0\",\"y_e4_c1 - z_c1 <= 0\",\"y_e4_c2 - z_c2 <= 0\",\"y_e4_c3 - z_c3 <= 0\",\"y_e4_c4 - z_c4 <= 0\",\"y_e5_c0 - z_c0 <= 0\",\"y_e5_c1 - z_c1 <= 0\",\"y_e5_c2 - z_c2 <= 0\",\"y_e5_c3 - z_c3 <= 0\",\"y_e5_c4 - z_c4 <= 0\",\"y_e6_c0 - z_c0 <= 0\",\"y_e6_c1 - z_c1 <= 0\",\"y_e6_c2 - z_c2 <= 0\",\"y_e6_c3 - z_c3 <= 0\",\"y_e6_c4 - z_c4 <= 0\"],\"optimizationFunction\":\"z_c0 + z_c1 + z_c2 + z_c3 + z_c4\",\"minimize\":true}\n");

        JSONObject output = solver.solve(input);
        assertEquals("{\"result\":[{\"variable\":\"x_v0_c0\",\"value\":\"0\"},{\"variable\":\"x_v0_c1\",\"value\":\"0\"},{\"variable\":\"x_v0_c2\",\"value\":\"0\"},{\"variable\":\"x_v0_c3\",\"value\":\"1\"},{\"variable\":\"x_v0_c4\",\"value\":\"0\"},{\"variable\":\"x_v1_c0\",\"value\":\"1\"},{\"variable\":\"x_v1_c1\",\"value\":\"0\"},{\"variable\":\"x_v1_c2\",\"value\":\"0\"},{\"variable\":\"x_v1_c3\",\"value\":\"0\"},{\"variable\":\"x_v1_c4\",\"value\":\"0\"},{\"variable\":\"x_v2_c0\",\"value\":\"0\"},{\"variable\":\"x_v2_c1\",\"value\":\"0\"},{\"variable\":\"x_v2_c2\",\"value\":\"1\"},{\"variable\":\"x_v2_c3\",\"value\":\"0\"},{\"variable\":\"x_v2_c4\",\"value\":\"0\"},{\"variable\":\"x_v3_c0\",\"value\":\"0\"},{\"variable\":\"x_v3_c1\",\"value\":\"0\"},{\"variable\":\"x_v3_c2\",\"value\":\"0\"},{\"variable\":\"x_v3_c3\",\"value\":\"1\"},{\"variable\":\"x_v3_c4\",\"value\":\"0\"},{\"variable\":\"x_v4_c0\",\"value\":\"0\"},{\"variable\":\"x_v4_c1\",\"value\":\"0\"},{\"variable\":\"x_v4_c2\",\"value\":\"0\"},{\"variable\":\"x_v4_c3\",\"value\":\"0\"},{\"variable\":\"x_v4_c4\",\"value\":\"1\"},{\"variable\":\"y_e0_c0\",\"value\":\"0\"},{\"variable\":\"y_e0_c1\",\"value\":\"0\"},{\"variable\":\"y_e0_c2\",\"value\":\"1\"},{\"variable\":\"y_e0_c3\",\"value\":\"0\"},{\"variable\":\"y_e0_c4\",\"value\":\"0\"},{\"variable\":\"y_e1_c0\",\"value\":\"1\"},{\"variable\":\"y_e1_c1\",\"value\":\"0\"},{\"variable\":\"y_e1_c2\",\"value\":\"0\"},{\"variable\":\"y_e1_c3\",\"value\":\"0\"},{\"variable\":\"y_e1_c4\",\"value\":\"0\"},{\"variable\":\"y_e2_c0\",\"value\":\"0\"},{\"variable\":\"y_e2_c1\",\"value\":\"0\"},{\"variable\":\"y_e2_c2\",\"value\":\"1\"},{\"variable\":\"y_e2_c3\",\"value\":\"0\"},{\"variable\":\"y_e2_c4\",\"value\":\"0\"},{\"variable\":\"y_e3_c0\",\"value\":\"1\"},{\"variable\":\"y_e3_c1\",\"value\":\"0\"},{\"variable\":\"y_e3_c2\",\"value\":\"0\"},{\"variable\":\"y_e3_c3\",\"value\":\"0\"},{\"variable\":\"y_e3_c4\",\"value\":\"0\"},{\"variable\":\"y_e4_c0\",\"value\":\"0\"},{\"variable\":\"y_e4_c1\",\"value\":\"0\"},{\"variable\":\"y_e4_c2\",\"value\":\"0\"},{\"variable\":\"y_e4_c3\",\"value\":\"0\"},{\"variable\":\"y_e4_c4\",\"value\":\"1\"},{\"variable\":\"y_e5_c0\",\"value\":\"0\"},{\"variable\":\"y_e5_c1\",\"value\":\"0\"},{\"variable\":\"y_e5_c2\",\"value\":\"0\"},{\"variable\":\"y_e5_c3\",\"value\":\"1\"},{\"variable\":\"y_e5_c4\",\"value\":\"0\"},{\"variable\":\"y_e6_c0\",\"value\":\"0\"},{\"variable\":\"y_e6_c1\",\"value\":\"0\"},{\"variable\":\"y_e6_c2\",\"value\":\"0\"},{\"variable\":\"y_e6_c3\",\"value\":\"0\"},{\"variable\":\"y_e6_c4\",\"value\":\"1\"},{\"variable\":\"z_c0\",\"value\":\"1\"},{\"variable\":\"z_c1\",\"value\":\"0\"},{\"variable\":\"z_c2\",\"value\":\"1\"},{\"variable\":\"z_c3\",\"value\":\"1\"},{\"variable\":\"z_c4\",\"value\":\"1\"}],\"errorMessage\":\"\",\"error\":false}", output.toString());
    }
    

    @Test
    void optionsFileNotPresent() {
        File optionsFile = new File("options");
        if (optionsFile.exists()) {
            if (!optionsFile.delete()) {
                fail("Could not delete options file");
            }
        }
        Solver solver = new Solver_GLPK();
        JSONObject input = new JSONObject("{\"variables\":[\"x_v0_c0\",\"x_v0_c1\",\"x_v0_c2\",\"x_v0_c3\",\"x_v0_c4\",\"x_v1_c0\",\"x_v1_c1\",\"x_v1_c2\",\"x_v1_c3\",\"x_v1_c4\",\"x_v2_c0\",\"x_v2_c1\",\"x_v2_c2\",\"x_v2_c3\",\"x_v2_c4\",\"x_v3_c0\",\"x_v3_c1\",\"x_v3_c2\",\"x_v3_c3\",\"x_v3_c4\",\"x_v4_c0\",\"x_v4_c1\",\"x_v4_c2\",\"x_v4_c3\",\"x_v4_c4\",\"y_e0_c0\",\"y_e0_c1\",\"y_e0_c2\",\"y_e0_c3\",\"y_e0_c4\",\"y_e1_c0\",\"y_e1_c1\",\"y_e1_c2\",\"y_e1_c3\",\"y_e1_c4\",\"y_e2_c0\",\"y_e2_c1\",\"y_e2_c2\",\"y_e2_c3\",\"y_e2_c4\",\"y_e3_c0\",\"y_e3_c1\",\"y_e3_c2\",\"y_e3_c3\",\"y_e3_c4\",\"y_e4_c0\",\"y_e4_c1\",\"y_e4_c2\",\"y_e4_c3\",\"y_e4_c4\",\"y_e5_c0\",\"y_e5_c1\",\"y_e5_c2\",\"y_e5_c3\",\"y_e5_c4\",\"y_e6_c0\",\"y_e6_c1\",\"y_e6_c2\",\"y_e6_c3\",\"y_e6_c4\",\"z_c0\",\"z_c1\",\"z_c2\",\"z_c3\",\"z_c4\"],\"constraints\":[\"x_v0_c0 + x_v0_c1 + x_v0_c2 + x_v0_c3 + x_v0_c4 = 1\",\"x_v1_c0 + x_v1_c1 + x_v1_c2 + x_v1_c3 + x_v1_c4 = 1\",\"x_v2_c0 + x_v2_c1 + x_v2_c2 + x_v2_c3 + x_v2_c4 = 1\",\"x_v3_c0 + x_v3_c1 + x_v3_c2 + x_v3_c3 + x_v3_c4 = 1\",\"x_v4_c0 + x_v4_c1 + x_v4_c2 + x_v4_c3 + x_v4_c4 = 1\",\"y_e0_c0 + y_e0_c1 + y_e0_c2 + y_e0_c3 + y_e0_c4 = 1\",\"y_e1_c0 + y_e1_c1 + y_e1_c2 + y_e1_c3 + y_e1_c4 = 1\",\"y_e2_c0 + y_e2_c1 + y_e2_c2 + y_e2_c3 + y_e2_c4 = 1\",\"y_e3_c0 + y_e3_c1 + y_e3_c2 + y_e3_c3 + y_e3_c4 = 1\",\"y_e4_c0 + y_e4_c1 + y_e4_c2 + y_e4_c3 + y_e4_c4 = 1\",\"y_e5_c0 + y_e5_c1 + y_e5_c2 + y_e5_c3 + y_e5_c4 = 1\",\"y_e6_c0 + y_e6_c1 + y_e6_c2 + y_e6_c3 + y_e6_c4 = 1\",\"x_v1_c0 + x_v3_c0 <= 1\",\"x_v1_c1 + x_v3_c1 <= 1\",\"x_v1_c2 + x_v3_c2 <= 1\",\"x_v1_c3 + x_v3_c3 <= 1\",\"x_v1_c4 + x_v3_c4 <= 1\",\"x_v0_c0 + x_v2_c0 <= 1\",\"x_v0_c1 + x_v2_c1 <= 1\",\"x_v0_c2 + x_v2_c2 <= 1\",\"x_v0_c3 + x_v2_c3 <= 1\",\"x_v0_c4 + x_v2_c4 <= 1\",\"x_v4_c0 + x_v0_c0 <= 1\",\"x_v4_c1 + x_v0_c1 <= 1\",\"x_v4_c2 + x_v0_c2 <= 1\",\"x_v4_c3 + x_v0_c3 <= 1\",\"x_v4_c4 + x_v0_c4 <= 1\",\"x_v3_c0 + x_v4_c0 <= 1\",\"x_v3_c1 + x_v4_c1 <= 1\",\"x_v3_c2 + x_v4_c2 <= 1\",\"x_v3_c3 + x_v4_c3 <= 1\",\"x_v3_c4 + x_v4_c4 <= 1\",\"x_v2_c0 + x_v3_c0 <= 1\",\"x_v2_c1 + x_v3_c1 <= 1\",\"x_v2_c2 + x_v3_c2 <= 1\",\"x_v2_c3 + x_v3_c3 <= 1\",\"x_v2_c4 + x_v3_c4 <= 1\",\"x_v1_c0 + x_v2_c0 <= 1\",\"x_v1_c1 + x_v2_c1 <= 1\",\"x_v1_c2 + x_v2_c2 <= 1\",\"x_v1_c3 + x_v2_c3 <= 1\",\"x_v1_c4 + x_v2_c4 <= 1\",\"x_v0_c0 + x_v1_c0 <= 1\",\"x_v0_c1 + x_v1_c1 <= 1\",\"x_v0_c2 + x_v1_c2 <= 1\",\"x_v0_c3 + x_v1_c3 <= 1\",\"x_v0_c4 + x_v1_c4 <= 1\",\"x_v0_c0 + y_e1_c0 + y_e2_c0 + y_e6_c0 <= 1\",\"x_v0_c1 + y_e1_c1 + y_e2_c1 + y_e6_c1 <= 1\",\"x_v0_c2 + y_e1_c2 + y_e2_c2 + y_e6_c2 <= 1\",\"x_v0_c3 + y_e1_c3 + y_e2_c3 + y_e6_c3 <= 1\",\"x_v0_c4 + y_e1_c4 + y_e2_c4 + y_e6_c4 <= 1\",\"x_v1_c0 + y_e0_c0 + y_e5_c0 + y_e6_c0 <= 1\",\"x_v1_c1 + y_e0_c1 + y_e5_c1 + y_e6_c1 <= 1\",\"x_v1_c2 + y_e0_c2 + y_e5_c2 + y_e6_c2 <= 1\",\"x_v1_c3 + y_e0_c3 + y_e5_c3 + y_e6_c3 <= 1\",\"x_v1_c4 + y_e0_c4 + y_e5_c4 + y_e6_c4 <= 1\",\"x_v2_c0 + y_e1_c0 + y_e4_c0 + y_e5_c0 <= 1\",\"x_v2_c1 + y_e1_c1 + y_e4_c1 + y_e5_c1 <= 1\",\"x_v2_c2 + y_e1_c2 + y_e4_c2 + y_e5_c2 <= 1\",\"x_v2_c3 + y_e1_c3 + y_e4_c3 + y_e5_c3 <= 1\",\"x_v2_c4 + y_e1_c4 + y_e4_c4 + y_e5_c4 <= 1\",\"x_v3_c0 + y_e0_c0 + y_e3_c0 + y_e4_c0 <= 1\",\"x_v3_c1 + y_e0_c1 + y_e3_c1 + y_e4_c1 <= 1\",\"x_v3_c2 + y_e0_c2 + y_e3_c2 + y_e4_c2 <= 1\",\"x_v3_c3 + y_e0_c3 + y_e3_c3 + y_e4_c3 <= 1\",\"x_v3_c4 + y_e0_c4 + y_e3_c4 + y_e4_c4 <= 1\",\"x_v4_c0 + y_e2_c0 + y_e3_c0 <= 1\",\"x_v4_c1 + y_e2_c1 + y_e3_c1 <= 1\",\"x_v4_c2 + y_e2_c2 + y_e3_c2 <= 1\",\"x_v4_c3 + y_e2_c3 + y_e3_c3 <= 1\",\"x_v4_c4 + y_e2_c4 + y_e3_c4 <= 1\",\"x_v0_c0 - z_c0 <= 0\",\"x_v0_c1 - z_c1 <= 0\",\"x_v0_c2 - z_c2 <= 0\",\"x_v0_c3 - z_c3 <= 0\",\"x_v0_c4 - z_c4 <= 0\",\"x_v1_c0 - z_c0 <= 0\",\"x_v1_c1 - z_c1 <= 0\",\"x_v1_c2 - z_c2 <= 0\",\"x_v1_c3 - z_c3 <= 0\",\"x_v1_c4 - z_c4 <= 0\",\"x_v2_c0 - z_c0 <= 0\",\"x_v2_c1 - z_c1 <= 0\",\"x_v2_c2 - z_c2 <= 0\",\"x_v2_c3 - z_c3 <= 0\",\"x_v2_c4 - z_c4 <= 0\",\"x_v3_c0 - z_c0 <= 0\",\"x_v3_c1 - z_c1 <= 0\",\"x_v3_c2 - z_c2 <= 0\",\"x_v3_c3 - z_c3 <= 0\",\"x_v3_c4 - z_c4 <= 0\",\"x_v4_c0 - z_c0 <= 0\",\"x_v4_c1 - z_c1 <= 0\",\"x_v4_c2 - z_c2 <= 0\",\"x_v4_c3 - z_c3 <= 0\",\"x_v4_c4 - z_c4 <= 0\",\"y_e0_c0 - z_c0 <= 0\",\"y_e0_c1 - z_c1 <= 0\",\"y_e0_c2 - z_c2 <= 0\",\"y_e0_c3 - z_c3 <= 0\",\"y_e0_c4 - z_c4 <= 0\",\"y_e1_c0 - z_c0 <= 0\",\"y_e1_c1 - z_c1 <= 0\",\"y_e1_c2 - z_c2 <= 0\",\"y_e1_c3 - z_c3 <= 0\",\"y_e1_c4 - z_c4 <= 0\",\"y_e2_c0 - z_c0 <= 0\",\"y_e2_c1 - z_c1 <= 0\",\"y_e2_c2 - z_c2 <= 0\",\"y_e2_c3 - z_c3 <= 0\",\"y_e2_c4 - z_c4 <= 0\",\"y_e3_c0 - z_c0 <= 0\",\"y_e3_c1 - z_c1 <= 0\",\"y_e3_c2 - z_c2 <= 0\",\"y_e3_c3 - z_c3 <= 0\",\"y_e3_c4 - z_c4 <= 0\",\"y_e4_c0 - z_c0 <= 0\",\"y_e4_c1 - z_c1 <= 0\",\"y_e4_c2 - z_c2 <= 0\",\"y_e4_c3 - z_c3 <= 0\",\"y_e4_c4 - z_c4 <= 0\",\"y_e5_c0 - z_c0 <= 0\",\"y_e5_c1 - z_c1 <= 0\",\"y_e5_c2 - z_c2 <= 0\",\"y_e5_c3 - z_c3 <= 0\",\"y_e5_c4 - z_c4 <= 0\",\"y_e6_c0 - z_c0 <= 0\",\"y_e6_c1 - z_c1 <= 0\",\"y_e6_c2 - z_c2 <= 0\",\"y_e6_c3 - z_c3 <= 0\",\"y_e6_c4 - z_c4 <= 0\"],\"optimizationFunction\":\"z_c0 + z_c1 + z_c2 + z_c3 + z_c4\",\"minimize\":true}\n");

        JSONObject output = solver.solve(input);
        assertEquals("{\"result\":[{\"variable\":\"x_v0_c0\",\"value\":\"0\"},{\"variable\":\"x_v0_c1\",\"value\":\"0\"},{\"variable\":\"x_v0_c2\",\"value\":\"0\"},{\"variable\":\"x_v0_c3\",\"value\":\"1\"},{\"variable\":\"x_v0_c4\",\"value\":\"0\"},{\"variable\":\"x_v1_c0\",\"value\":\"1\"},{\"variable\":\"x_v1_c1\",\"value\":\"0\"},{\"variable\":\"x_v1_c2\",\"value\":\"0\"},{\"variable\":\"x_v1_c3\",\"value\":\"0\"},{\"variable\":\"x_v1_c4\",\"value\":\"0\"},{\"variable\":\"x_v2_c0\",\"value\":\"0\"},{\"variable\":\"x_v2_c1\",\"value\":\"0\"},{\"variable\":\"x_v2_c2\",\"value\":\"1\"},{\"variable\":\"x_v2_c3\",\"value\":\"0\"},{\"variable\":\"x_v2_c4\",\"value\":\"0\"},{\"variable\":\"x_v3_c0\",\"value\":\"0\"},{\"variable\":\"x_v3_c1\",\"value\":\"0\"},{\"variable\":\"x_v3_c2\",\"value\":\"0\"},{\"variable\":\"x_v3_c3\",\"value\":\"1\"},{\"variable\":\"x_v3_c4\",\"value\":\"0\"},{\"variable\":\"x_v4_c0\",\"value\":\"0\"},{\"variable\":\"x_v4_c1\",\"value\":\"0\"},{\"variable\":\"x_v4_c2\",\"value\":\"0\"},{\"variable\":\"x_v4_c3\",\"value\":\"0\"},{\"variable\":\"x_v4_c4\",\"value\":\"1\"},{\"variable\":\"y_e0_c0\",\"value\":\"0\"},{\"variable\":\"y_e0_c1\",\"value\":\"0\"},{\"variable\":\"y_e0_c2\",\"value\":\"1\"},{\"variable\":\"y_e0_c3\",\"value\":\"0\"},{\"variable\":\"y_e0_c4\",\"value\":\"0\"},{\"variable\":\"y_e1_c0\",\"value\":\"1\"},{\"variable\":\"y_e1_c1\",\"value\":\"0\"},{\"variable\":\"y_e1_c2\",\"value\":\"0\"},{\"variable\":\"y_e1_c3\",\"value\":\"0\"},{\"variable\":\"y_e1_c4\",\"value\":\"0\"},{\"variable\":\"y_e2_c0\",\"value\":\"0\"},{\"variable\":\"y_e2_c1\",\"value\":\"0\"},{\"variable\":\"y_e2_c2\",\"value\":\"1\"},{\"variable\":\"y_e2_c3\",\"value\":\"0\"},{\"variable\":\"y_e2_c4\",\"value\":\"0\"},{\"variable\":\"y_e3_c0\",\"value\":\"1\"},{\"variable\":\"y_e3_c1\",\"value\":\"0\"},{\"variable\":\"y_e3_c2\",\"value\":\"0\"},{\"variable\":\"y_e3_c3\",\"value\":\"0\"},{\"variable\":\"y_e3_c4\",\"value\":\"0\"},{\"variable\":\"y_e4_c0\",\"value\":\"0\"},{\"variable\":\"y_e4_c1\",\"value\":\"0\"},{\"variable\":\"y_e4_c2\",\"value\":\"0\"},{\"variable\":\"y_e4_c3\",\"value\":\"0\"},{\"variable\":\"y_e4_c4\",\"value\":\"1\"},{\"variable\":\"y_e5_c0\",\"value\":\"0\"},{\"variable\":\"y_e5_c1\",\"value\":\"0\"},{\"variable\":\"y_e5_c2\",\"value\":\"0\"},{\"variable\":\"y_e5_c3\",\"value\":\"1\"},{\"variable\":\"y_e5_c4\",\"value\":\"0\"},{\"variable\":\"y_e6_c0\",\"value\":\"0\"},{\"variable\":\"y_e6_c1\",\"value\":\"0\"},{\"variable\":\"y_e6_c2\",\"value\":\"0\"},{\"variable\":\"y_e6_c3\",\"value\":\"0\"},{\"variable\":\"y_e6_c4\",\"value\":\"1\"},{\"variable\":\"z_c0\",\"value\":\"1\"},{\"variable\":\"z_c1\",\"value\":\"0\"},{\"variable\":\"z_c2\",\"value\":\"1\"},{\"variable\":\"z_c3\",\"value\":\"1\"},{\"variable\":\"z_c4\",\"value\":\"1\"}],\"errorMessage\":\"\",\"error\":false}", output.toString());

    }

    @Test
    void notSolvable() {
        Solver solver = new Solver_GLPK();
        JSONObject input = new JSONObject("{\"minimize\":true,\"optimizationFunction\":\"z_c0 + z_c1 + z_c2\",\"variables\":[\"x_v0_c0\",\"x_v0_c1\",\"x_v0_c2\",\"x_v1_c0\",\"x_v1_c1\",\"x_v1_c2\",\"y_e0_c0\",\"y_e0_c1\",\"y_e0_c2\",\"z_c0\",\"z_c1\",\"z_c2\"],\"constraints\":[\"x_v0_c0 + x_v0_c1 + x_v0_c2 = 1\",\"x_v0_c0 = 1\",\"x_v1_c0 + x_v1_c1 + x_v1_c2 = 1\",\"x_v1_c0 = 1\",\"y_e0_c0 + y_e0_c1 + y_e0_c2 = 1\",\"x_v0_c0 + x_v1_c0 <= 1\",\"x_v0_c1 + x_v1_c1 <= 1\",\"x_v0_c2 + x_v1_c2 <= 1\",\"x_v0_c0 + y_e0_c0 <= 1\",\"x_v0_c1 + y_e0_c1 <= 1\",\"x_v0_c2 + y_e0_c2 <= 1\",\"x_v1_c0 + y_e0_c0 <= 1\",\"x_v1_c1 + y_e0_c1 <= 1\",\"x_v1_c2 + y_e0_c2 <= 1\",\"x_v0_c0 - z_c0 <= 0\",\"x_v0_c1 - z_c1 <= 0\",\"x_v0_c2 - z_c2 <= 0\",\"x_v1_c0 - z_c0 <= 0\",\"x_v1_c1 - z_c1 <= 0\",\"x_v1_c2 - z_c2 <= 0\",\"y_e0_c0 - z_c0 <= 0\",\"y_e0_c1 - z_c1 <= 0\",\"y_e0_c2 - z_c2 <= 0\"]}\n");

        JSONObject output = solver.solve(input);
        assertEquals("{\"result\":[],\"errorMessage\":\"The problem is not solvable.\",\"error\":true}", output.toString());
    }

    @Test
    void notInstalled() {
        Solver solver = new Solver_GLPK_not_installed();
        JSONObject input = new JSONObject("{\"minimize\":true,\"optimizationFunction\":\"z_c0 + z_c1 + z_c2\",\"variables\":[\"x_v0_c0\",\"x_v0_c1\",\"x_v0_c2\",\"x_v1_c0\",\"x_v1_c1\",\"x_v1_c2\",\"y_e0_c0\",\"y_e0_c1\",\"y_e0_c2\",\"z_c0\",\"z_c1\",\"z_c2\"],\"constraints\":[\"x_v0_c0 + x_v0_c1 + x_v0_c2 = 1\",\"x_v0_c0 = 1\",\"x_v1_c0 + x_v1_c1 + x_v1_c2 = 1\",\"x_v1_c0 = 1\",\"y_e0_c0 + y_e0_c1 + y_e0_c2 = 1\",\"x_v0_c0 + x_v1_c0 <= 1\",\"x_v0_c1 + x_v1_c1 <= 1\",\"x_v0_c2 + x_v1_c2 <= 1\",\"x_v0_c0 + y_e0_c0 <= 1\",\"x_v0_c1 + y_e0_c1 <= 1\",\"x_v0_c2 + y_e0_c2 <= 1\",\"x_v1_c0 + y_e0_c0 <= 1\",\"x_v1_c1 + y_e0_c1 <= 1\",\"x_v1_c2 + y_e0_c2 <= 1\",\"x_v0_c0 - z_c0 <= 0\",\"x_v0_c1 - z_c1 <= 0\",\"x_v0_c2 - z_c2 <= 0\",\"x_v1_c0 - z_c0 <= 0\",\"x_v1_c1 - z_c1 <= 0\",\"x_v1_c2 - z_c2 <= 0\",\"y_e0_c0 - z_c0 <= 0\",\"y_e0_c1 - z_c1 <= 0\",\"y_e0_c2 - z_c2 <= 0\"]}\n");

        JSONObject output = solver.solve(input);
        assertEquals("{\"result\":[],\"errorMessage\":\"GLPK is not installed or not reachable.\",\"error\":true}", output.toString());
    }

    @Test
    void invalidJson() {
        Solver solver = new Solver_GLPK();
        JSONObject input = new JSONObject("{\"minimize\":true,\"optimizationFunction\":\"z_c0 + z_c1\",\"variables\":[\"z_c0\",\"z_c1\"],\"constraints\":[]}");
        JSONObject output = solver.solve(input);
        assertEquals("{\"result\":[],\"errorMessage\":\"Cannot solve empty graph\",\"error\":true}", output.toString());
        input = new JSONObject();
        output = solver.solve(input);
        assertEquals("{\"result\":[],\"errorMessage\":\"JSONObject[\\\"variables\\\"] not found.\",\"error\":true}", output.toString());
    }
}